<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Expert Polyhomes - Premium mosquito mesh solutions in Nairobi. Custom rollers, sliders, fixed, and magnetic nets for your home.">
  <meta name="keywords" content="mosquito nets Nairobi, window screens Kenya, insect mesh, rollers, sliders, magnetic nets, home protection">
  <title>EXPERT POLYHOMES | Mosquito Net Solutions</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
  <link rel="stylesheet" href="https://unpkg.com/aos@2.3.1/dist/aos.css" />
  <link rel="stylesheet" href="style.css">
  <link rel="icon" href="Assets/images/favicon.ico">
</head>
<body>
  <!-- AR View Button -->
  <button id="arView" class="ar-button" aria-label="Open AR View to measure windows">
    <i class="ar-icon"></i> View & Measure
  </button>

  <!-- Sticky Quote Banner -->
  <div class="sticky-banner" id="stickyBanner">
    <p>Protect your home today! <a href="#quote" class="btn-primary">Get Your Free Quote</a></p>
  </div>

  <!-- Live Chat Button -->
  <button class="chat-button" id="chatButton" aria-label="Open live chat">
    <i class="chat-icon"></i> Chat with Us
  </button>

  <!-- AR View Modal -->
  <div id="arModal" class="modal" style="display:none;" role="dialog" aria-labelledby="arModalTitle">
    <div class="modal-container">
      <button class="modal-close" id="closeArModal" aria-label="Close AR Modal">&times;</button>
      <div class="modal-header">
        <h2 id="arModalTitle">Measure Your Window</h2>
        <p>Place a standard card (e.g., credit card, 8.5cm wide) against your window. Adjust the ruler to match, then enter measurements.</p>
      </div>
      <div class="modal-body">
        <div style="position:relative;">
          <video id="arCamera" autoplay playsinline style="width:100%;max-width:400px;border-radius:8px;"></video>
          <div id="rulerOverlay" style="position:absolute;top:50%;left:10%;width:60px;height:8px;background:#133A41;opacity:0.7;cursor:ew-resize;border-radius:4px;"></div>
          <span id="rulerLength" style="position:absolute;top:calc(50% + 12px);left:10%;color:#133A41;font-weight:bold;"></span>
        </div>
        <form id="arDimensionForm" style="margin-top:1em;">
          <div class="input-group">
            <label for="arWidth">Window Width (cm)</label>
            <input type="number" id="arWidth" min="10" step="0.1" required aria-required="true">
          </div>
          <div class="input-group">
            <label for="arHeight">Window Height (cm)</label>
            <input type="number" id="arHeight" min="10" step="0.1" required aria-required="true">
          </div>
          <div class="form-actions">
            <button type="submit" class="btn-primary">Submit for Quote</button>
          </div>
        </form>
        <div style="font-size:0.9em;color:#888;margin-top:0.5em;">
          * Use a credit card for accurate scaling. Contact us for assistance.
        </div>
      </div>
    </div>
  </div>

  <!-- Utility Bar -->
  <div class="utility-bar">
    <div class="container">
      <div class="features">
        <span id="live-time"></span>
        <span id="weather-display"></span>
      </div>
      <div class="auth-section">
        <span id="user-greeting"></span>
        <a href="#" id="signInLink" aria-label="Sign In to your account">Sign In</a>
        <a href="/dashboard" id="dashboardLink" aria-label="Go to your dashboard">Dashboard</a>
        <a href="#" id="logoutLink" aria-label="Log out">Logout</a>
      </div>
    </div>
  </div>

  <!-- Navigation -->
  <nav class="nav">
    <div class="container">
      <div class="nav-brand">
        <a href="/" class="logo" aria-label="Expert Polyhomes Home">
          <span class="logo-icon">EP</span>
          <span class="logo-text">EXPERT POLYHOMES</span>
        </a>
        <div class="nav-toggle" id="navToggle" aria-label="Toggle navigation menu">
          <span class="toggle-bar"></span>
          <span class="toggle-bar"></span>
          <span class="toggle-bar"></span>
        </div>
      </div>
      <ul class="nav-links" id="navLinks">
        <li><a href="#home" class="nav-link active" data-section="home">Home</a></li>
        <li><a href="#solutions" class="nav-link" data-section="solutions">Solutions</a></li>
        <li><a href="#design-explorer" class="nav-link" data-section="design-explorer">Design Explorer</a></li>
        <li><a href="#process" class="nav-link" data-section="process">Our Process</a></li>
        <li><a href="#testimonials" class="nav-link" data-section="testimonials">Testimonials</a></li>
        <li><a href="#contact" class="nav-link" data-section="contact">Contact</a></li>
        <li class="nav-cta"><a href="#quote" class="btn-primary">Get a Quote</a></li>
      </ul>
    </div>
  </nav>

  <!-- Hero Section -->
  <section class="hero" id="home" data-aos="fade-up">
    <div class="hero-bg" style="background: url('Assets/images/hero/hero-window-screen.jpg') no-repeat center/cover;"></div>
    <div class="container">
      <div class="hero-content">
        <h1 class="hero-title">Protect Your Home with <span>Stylish Mosquito Nets</span></h1>
        <p class="hero-subtitle">Discover rollers, sliders, fixed, and magnetic nets tailored for Nairobi homes.</p>
        <div class="hero-actions">
          <a href="#quote" class="btn-primary btn-lg">Get Your Free Quote</a>
          <a href="#design-explorer" class="btn-secondary btn-lg">Explore Designs</a>
        </div>
        <div class="material-selector" role="radiogroup" aria-label="Select net material for preview">
          <label class="material-option">
            <input type="radio" name="material" value="fiberglass" checked aria-label="Fiberglass material">
            Fiberglass
          </label>
          <label class="material-option">
            <input type="radio" name="material" value="polyester" aria-label="Polyester material">
            Polyester
          </label>
          <label class="material-option">
            <input type="radio" name="material" value="stainless" aria-label="Stainless steel material">
            Stainless Steel
          </label>
        </div>
      </div>
      <div class="hero-visual">
        <div class="product-visualization" id="product3d"></div>
      </div>
    </div>
  </section>

  <!-- Solutions Section -->
  <section class="solutions" id="solutions" data-aos="fade-up" data-aos-delay="100">
    <div class="container">
      <div class="section-header">
        <h2>Our <span>Custom</span> Solutions</h2>
        <p>High-quality mosquito nets for every home and budget</p>
      </div>
      <div class="solutions-grid">
        <div class="solution-card basic" data-aos="zoom-in" data-aos-delay="200">
          <div class="card-header">
            <h3>Essential Protection</h3>
            <div class="price-badge">From KES 1,500/m²</div>
          </div>
          <div class="card-body">
            <div class="card-visual">
              <img src="Assets/images/solutions/magneticmesh1.jfif" alt="Basic Aluminum Mesh" loading="lazy">
            </div>
            <ul class="card-features">
              <li><i class="icon-check"></i> Durable aluminum frames</li>
              <li><i class="icon-check"></i> Fiberglass mesh (5-year warranty)</li>
              <li><i class="icon-check"></i> Fixed or magnetic options</li>
              <li><i class="icon-check"></i> Easy installation</li>
            </ul>
          </div>
          <div class="card-footer">
            <a href="essential.html" class="btn-outline">View Details</a>
            <a href="#quote" class="btn-primary quick-order" data-type="essential">Quick Order</a>
            <span class="best-for">Best for: Rentals & Budget Homes</span>
          </div>
        </div>
        <div class="solution-card standard" data-aos="zoom-in" data-aos-delay="300">
          <div class="card-header">
            <h3>Standard Plus</h3>
            <div class="price-badge">From KES 2,800/m²</div>
          </div>
          <div class="card-body">
            <div class="card-visual">
              <img src="Assets/images/solutions/windowmesh3.jfif" alt="Retractable Mesh" loading="lazy">
            </div>
            <ul class="card-features">
              <li><i class="icon-check"></i> Retractable or slider systems</li>
              <li><i class="icon-check"></i> Anti-dust polyester mesh</li>
              <li><i class="icon-check"></i> Child-safe mechanisms</li>
              <li><i class="icon-check"></i> 8-year warranty</li>
            </ul>
          </div>
          <div class="card-footer">
            <a href="standard.html" class="btn-outline">View Details</a>
            <a href="#quote" class="btn-primary quick-order" data-type="standard">Quick Order</a>
            <span class="best-for">Best for: Family Homes</span>
          </div>
        </div>
        <div class="solution-card premium" data-aos="zoom-in" data-aos-delay="400">
          <div class="card-header">
            <h3>Premium Comfort</h3>
            <div class="price-badge">From KES 4,500/m²</div>
          </div>
          <div class="card-body">
            <div class="card-visual">
              <img src="Assets/images/solutions/doormesh1.jfif" alt="Magnetic Mesh" loading="lazy">
            </div>
            <ul class="card-features">
              <li><i class="icon-check"></i> Roller or magnetic systems</li>
              <li><i class="icon-check"></i> Pet-resistant stainless mesh</li>
              <li><i class="icon-check"></i> Custom color matching</li>
              <li><i class="icon-check"></i> 10-year warranty</li>
            </ul>
          </div>
          <div class="card-footer">
            <a href="premium.html" class="btn-outline">View Details</a>
            <a href="#quote" class="btn-primary quick-order" data-type="premium">Quick Order</a>
            <span class="best-for">Best for: Luxury Homes & Offices</span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Design Explorer Section -->
  <section class="design-explorer" id="design-explorer" data-aos="fade-up" data-aos-delay="100">
    <div class="container">
      <div class="section-header">
        <h2>Explore Our <span>Net Designs</span></h2>
        <p>Choose from rollers, sliders, fixed, or magnetic nets to suit your home</p>
      </div>
      <div class="design-tabs" role="tablist">
        <button class="tab-button active" data-tab="fixed" role="tab" aria-selected="true" aria-controls="fixed-panel">Fixed</button>
        <button class="tab-button" data-tab="roller" role="tab" aria-selected="false" aria-controls="roller-panel">Roller</button>
        <button class="tab-button" data-tab="slider" role="tab" aria-selected="false" aria-controls="slider-panel">Slider</button>
        <button class="tab-button" data-tab="magnetic" role="tab" aria-selected="false" aria-controls="magnetic-panel">Magnetic</button>
      </div>
      <div class="design-content">
        <div class="design-tab active" id="fixed-panel" data-tab="fixed" role="tabpanel" data-aos="fade-right">
          <div class="design-image">
            <img src="Assets/images/solutions/doormesh1.jfif" alt="Fixed Mosquito Net" loading="lazy">
          </div>
          <div class="design-info">
            <h3>Fixed Mosquito Nets</h3>
            <p>Perfect for permanent protection on windows and small openings. Durable and low-maintenance.</p>
            <ul class="feature-list">
              <li>Aluminum or PVC frames</li>
              <li>Fiberglass or polyester mesh</li>
              <li>5-10 year durability</li>
              <li>From KES 1,500/m²</li>
            </ul>
            <form class="configurator-form" data-type="fixed" aria-label="Configure Fixed Mosquito Net">
              <div class="input-group">
                <label for="fixed-quantity">Quantity</label>
                <input type="number" id="fixed-quantity" min="1" value="1" required aria-required="true">
              </div>
              <div class="input-group">
                <label for="fixed-material">Material</label>
                <select id="fixed-material" required aria-required="true">
                  <option value="fiberglass">Fiberglass</option>
                  <option value="polyester">Polyester</option>
                </select>
              </div>
              <div class="input-group">
                <label for="fixed-width">Width (cm)</label>
                <input type="number" id="fixed-width" min="10" step="0.1" required aria-required="true">
              </div>
              <div class="input-group">
                <label for="fixed-height">Height (cm)</label>
                <input type="number" id="fixed-height" min="10" step="0.1" required aria-required="true">
              </div>
              <button type="submit" class="btn-primary">Add to Quote</button>
            </form>
          </div>
        </div>
        <div class="design-tab" id="roller-panel" data-tab="roller" role="tabpanel" data-aos="fade-right">
          <div class="design-image">
            <img src="Assets/images/solutions/doormesh2.jfif" alt="Roller Mosquito Net" loading="lazy">
          </div>
          <div class="design-info">
            <h3>Roller Mosquito Nets</h3>
            <p>Retractable nets for easy use on large windows or doors. Sleek and modern design.</p>
            <ul class="feature-list">
              <li>Smooth roller mechanism</li>
              <li>Polyester or stainless mesh</li>
              <li>8-10 year durability</li>
              <li>From KES 3,500/m²</li>
            </ul>
            <form class="configurator-form" data-type="roller" aria-label="Configure Roller Mosquito Net">
              <div class="input-group">
                <label for="roller-quantity">Quantity</label>
                <input type="number" id="roller-quantity" min="1" value="1" required aria-required="true">
              </div>
              <div class="input-group">
                <label for="roller-material">Material</label>
                <select id="roller-material" required aria-required="true">
                  <option value="polyester">Polyester</option>
                  <option value="stainless">Stainless Steel</option>
                </select>
              </div>
              <div class="input-group">
                <label for="roller-width">Width (cm)</label>
                <input type="number" id="roller-width" min="10" step="0.1" required aria-required="true">
              </div>
              <div class="input-group">
                <label for="roller-height">Height (cm)</label>
                <input type="number" id="roller-height" min="10" step="0.1" required aria-required="true">
              </div>
              <button type="submit" class="btn-primary">Add to Quote</button>
            </form>
          </div>
        </div>
        <div class="design-tab" id="slider-panel" data-tab="slider" role="tabpanel" data-aos="fade-right">
          <div class="design-image">
            <img src="Assets/images/solutions/materialmesh1.jfif" alt="Slider Mosquito Net" loading="lazy">
          </div>
          <div class="design-info">
            <h3>Slider Mosquito Nets</h3>
            <p>Ideal for sliding doors or large windows. Easy to slide open and close.</p>
            <ul class="feature-list">
              <li>Aluminum tracks</li>
              <li>Polyester or stainless mesh</li>
              <li>8-10 year durability</li>
              <li>From KES 3,200/m²</li>
            </ul>
            <form class="configurator-form" data-type="slider" aria-label="Configure Slider Mosquito Net">
              <div class="input-group">
                <label for="slider-quantity">Quantity</label>
                <input type="number" id="slider-quantity" min="1" value="1" required aria-required="true">
              </div>
              <div class="input-group">
                <label for="slider-material">Material</label>
                <select id="slider-material" required aria-required="true">
                  <option value="polyester">Polyester</option>
                  <option value="stainless">Stainless Steel</option>
                </select>
              </div>
              <div class="input-group">
                <label for="slider-width">Width (cm)</label>
                <input type="number" id="slider-width" min="10" step="0.1" required aria-required="true">
              </div>
              <div class="input-group">
                <label for="slider-height">Height (cm)</label>
                <input type="number" id="slider-height" min="10" step="0.1" required aria-required="true">
              </div>
              <button type="submit" class="btn-primary">Add to Quote</button>
            </form>
          </div>
        </div>
        <div class="design-tab" id="magnetic-panel" data-tab="magnetic" role="tabpanel" data-aos="fade-right">
          <div class="design-image">
            <img src="Assets/images/solutions/magneticmesh1.jfif" alt="Magnetic Mosquito Net" loading="lazy">
          </div>
          <div class="design-info">
            <h3>Magnetic Mosquito Nets</h3>
            <p>Easy to install and remove. Perfect for rentals or temporary setups.</p>
            <ul class="feature-list">
              <li>Magnetic or velcro fixing</li>
              <li>Fiberglass or polyester mesh</li>
              <li>5-7 year durability</li>
              <li>From KES 1,800/m²</li>
            </ul>
            <form class="configurator-form" data-type="magnetic" aria-label="Configure Magnetic Mosquito Net">
              <div class="input-group">
                <label for="magnetic-quantity">Quantity</label>
                <input type="number" id="magnetic-quantity" min="1" value="1" required aria-required="true">
              </div>
              <div class="input-group">
                <label for="magnetic-material">Material</label>
                <select id="magnetic-material" required aria-required="true">
                  <option value="fiberglass">Fiberglass</option>
                  <option value="polyester">Polyester</option>
                </select>
              </div>
              <div class="input-group">
                <label for="magnetic-width">Width (cm)</label>
                <input type="number" id="magnetic-width" min="10" step="0.1" required aria-required="true">
              </div>
              <div class="input-group">
                <label for="magnetic-height">Height (cm)</label>
                <input type="number" id="magnetic-height" min="10" step="0.1" required aria-required="true">
              </div>
              <button type="submit" class="btn-primary">Add to Quote</button>
            </form>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Process Section -->
  <section class="process" id="process" data-aos="fade-up" data-aos-delay="100">
    <div class="container">
      <div class="section-header">
        <h2>Our <span>Simple</span> Process</h2>
        <p>From measurement to professional installation</p>
      </div>
      <div class="process-steps">
        <div class="process-step" data-aos="zoom-in" data-aos-delay="200">
          <div class="step-number">1</div>
          <div class="step-content">
            <h3>Measure Your Windows</h3>
            <p>Use our AR tool or request a free on-site measurement.</p>
          </div>
        </div>
        <div class="process-step" data-aos="zoom-in" data-aos-delay="300">
          <div class="step-number">2</div>
          <div class="step-content">
            <h3>Customize & Quote</h3>
            <p>Choose your net design and get an instant quote.</p>
          </div>
        </div>
        <div class="process-step" data-aos="zoom-in" data-aos-delay="400">
          <div class="step-number">3</div>
          <div class="step-content">
            <h3>Professional Installation</h3>
            <p>Our team installs your nets with precision.</p>
          </div>
        </div>
        <div class="process-step" data-aos="zoom-in" data-aos-delay="500">
          <div class="step-number">4</div>
          <div class="step-content">
            <h3>Enjoy Protection</h3>
            <p>Your home is now mosquito-free and stylish.</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Coverage Map Section -->
  <section class="coverage-map" id="contact" data-aos="fade-up" data-aos-delay="100">
    <div class="container">
      <div class="section-header">
        <h2>Our <span>Service</span> Coverage</h2>
        <p>Currently serving Nairobi and surrounding areas</p>
      </div>
      <div class="map-container">
        <div id="serviceMap"></div>
        <div class="map-overlay">
          <h3>Check Availability</h3>
          <p>Enter your address to see installation times.</p>
          <div class="location-search">
            <input type="text" id="locationInput" placeholder="Enter your address" aria-label="Enter your address to check coverage">
            <button id="checkLocation" class="btn-primary" aria-label="Check service coverage">Check Coverage</button>
          </div>
          <div class="delivery-estimate" id="deliveryEstimate">
            <i class="icon-delivery-truck"></i>
            <span>Estimated installation: <strong id="installTime">--</strong></span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Reviews Section -->
  <section class="reviews" id="testimonials" data-aos="fade-up" data-aos-delay="100">
    <div class="container">
      <h2>What Our Customers Say</h2>
      <div class="review-grid" id="reviewsContainer"></div>
      <form id="reviewForm" aria-label="Submit a customer review">
        <select name="rating" required aria-required="true">
          <option value="">Select Rating</option>
          <option value="5">★★★★★</option>
          <option value="4">★★★★☆</option>
          <option value="3">★★★☆☆</option>
          <option value="2">★★☆☆☆</option>
          <option value="1">★☆☆☆☆</option>
        </select>
        <textarea name="comment" placeholder="Share your experience..." required aria-required="true"></textarea>
        <button type="submit" class="btn-primary">Submit Review</button>
      </form>
    </div>
  </section>

  <!-- Quote Modal -->
  <div class="modal" id="quoteModal" role="dialog" aria-labelledby="quoteModalTitle">
    <div class="modal-container">
      <button class="modal-close" id="closeQuote" aria-label="Close Quote Modal">&times;</button>
      <div class="modal-header">
        <h2 id="quoteModalTitle">Instant Quote Generator</h2>
        <p>Get a free estimate in just a few steps</p>
      </div>
      <div class="modal-body">
        <form id="smartQuoteForm" aria-label="Generate a quote for mosquito nets">
          <div class="form-step active" data-step="1">
            <h3>Property Type</h3>
            <div class="option-grid">
              <label class="option-card">
                <input type="radio" name="propertyType" value="residential" checked aria-label="Residential property">
                <div class="card-content">
                  <i class="icon-home"></i>
                  <span>Residential</span>
                </div>
              </label>
              <label class="option-card">
                <input type="radio" name="propertyType" value="commercial" aria-label="Commercial property">
                <div class="card-content">
                  <i class="icon-building"></i>
                  <span>Commercial</span>
                </div>
              </label>
            </div>
            <button type="button" class="btn-primary next-step">Next</button>
          </div>
          <div class="form-step" data-step="2">
            <h3>Window/Door Details</h3>
            <div class="input-group">
              <label for="windowWidth">Width (meters)</label>
              <input type="number" step="0.1" min="0.5" id="windowWidth" required aria-required="true">
            </div>
            <div class="input-group">
              <label for="windowHeight">Height (meters)</label>
              <input type="number" step="0.1" min="0.5" id="windowHeight" required aria-required="true">
            </div>
            <div class="input-group">
              <label for="windowCount">Number of Windows/Doors</label>
              <input type="number" min="1" value="1" id="windowCount" required aria-required="true">
            </div>
            <div class="input-group">
              <label for="meshType">Net Type</label>
              <select id="meshType" required aria-required="true">
                <option value="fixed">Fixed</option>
                <option value="roller">Roller</option>
                <option value="slider">Slider</option>
                <option value="magnetic">Magnetic</option>
              </select>
            </div>
            <div class="input-group">
              <label for="materialType">Material</label>
              <select id="materialType" required aria-required="true">
                <option value="fiberglass">Fiberglass</option>
                <option value="polyester">Polyester</option>
                <option value="stainless">Stainless Steel</option>
              </select>
            </div>
            <div class="form-actions">
              <button type="button" class="btn-outline prev-step">Back</button>
              <button type="button" class="btn-primary next-step">Next</button>
            </div>
          </div>
          <div class="form-step" data-step="3">
            <h3>Location & Contact</h3>
            <div class="input-group">
              <label for="installLocation">Your Location</label>
              <div class="location-input">
                <input type="text" id="installLocation" placeholder="Enter your address" required aria-required="true">
                <button type="button" id="detectLocation" class="btn-icon" aria-label="Detect current location">
                  <i class="icon-gps"></i>
                </button>
              </div>
            </div>
            <div class="input-group">
              <label for="quoteEmail">Email Address</label>
              <input type="email" id="quoteEmail" placeholder="For your quote details" required aria-required="true">
            </div>
            <div class="payment-options">
              <button id="mpesapay" class="btn-payment">
                <img src="./Assets/images/mpesa/mpesa-logo.png" alt="M-Pesa">
                Pay 50% Deposit via M-Pesa
                <span class="secure-badge">Secure Payment</span>
              </button>
            </div>
            <div class="form-actions">
              <button type="button" class="btn-outline prev-step">Back</button>
              <button type="submit" class="btn-primary">Get Instant Quote</button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- M-Pesa Modal -->
  <div class="modal" id="mpesaModal" role="dialog" aria-labelledby="mpesaModalTitle">
    <div class="modal-container">
      <button class="modal-close" id="closeMpesaModal" aria-label="Close M-Pesa Modal">&times;</button>
      <div class="modal-header">
        <h2 id="mpesaModalTitle">Confirm M-Pesa Payment</h2>
        <p>Pay a 50% deposit to confirm your order.</p>
      </div>
      <div class="modal-body">
        <p><strong>Total Quote:</strong> KES <span id="mpesaTotal">0</span></p>
        <p><strong>Deposit (50%):</strong> KES <span id="mpesaDeposit">0</span></p>
        <div class="input-group">
          <label for="mpesaPhone">Phone Number</label>
          <input type="tel" id="mpesaPhone" placeholder="e.g., 0712345678" required aria-required="true">
        </div>
        <p class="trust-note">✅ Secure payment via M-Pesa. Full refund if we can't deliver.</p>
        <div class="form-actions">
          <button type="button" class="btn-outline" id="cancelMpesa">Cancel</button>
          <button type="button" class="btn-payment" id="confirmMpesa">
            <img src="./Assets/images/mpesa/mpesa-logo.png" alt="M-Pesa">
            Confirm Deposit
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Sign-In Modal -->
  <div class="modal" id="signInModal" role="dialog" aria-labelledby="signInModalTitle">
    <div class="modal-container">
      <button class="modal-close" id="closeSignInModal" aria-label="Close Sign-In Modal">&times;</button>
      <div class="modal-header">
        <h2 id="signInModalTitle">Sign In</h2>
        <p>Access your dashboard and track quotes.</p>
      </div>
      <div class="modal-body">
        <form id="signInForm" aria-label="Sign in to your account">
          <div class="input-group">
            <label for="signInEmail">Email</label>
            <input type="email" id="signInEmail" placeholder="e.g., user@example.com" required aria-required="true">
          </div>
          <div class="input-group">
            <label for="signInPassword">Password</label>
            <input type="password" id="signInPassword" placeholder="Enter your password" required aria-required="true">
          </div>
          <div class="form-options">
            <label>
              <input type="checkbox" name="remember" aria-label="Remember me"> Remember me
            </label>
            <a href="#" class="forgot-password">Forgot Password?</a>
          </div>
          <div class="form-actions">
            <button type="submit" class="btn-primary">Sign In</button>
            <p>Don't have an account? <a href="#" id="showRegisterModal">Sign Up</a></p>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Register Modal -->
  <div class="modal" id="registerModal" role="dialog" aria-labelledby="registerModalTitle">
    <div class="modal-container">
      <button class="modal-close" id="closeRegisterModal" aria-label="Close Register Modal">&times;</button>
      <div class="modal-header">
        <h2 id="registerModalTitle">Create an Account</h2>
        <p>Join Expert Polyhomes to manage your quotes.</p>
      </div>
      <div class="modal-body">
        <form id="registerForm" aria-label="Create a new account">
          <div class="input-group">
            <label for="registerName">Full Name</label>
            <input type="text" id="registerName" placeholder="e.g., John Doe" required aria-required="true">
          </div>
          <div class="input-group">
            <label for="registerEmail">Email</label>
            <input type="email" id="registerEmail" placeholder="e.g., user@example.com" required aria-required="true">
          </div>
          <div class="input-group">
            <label for="registerPassword">Password</label>
            <input type="password" id="registerPassword" placeholder="Create a password" required aria-required="true">
          </div>
          <div class="form-actions">
            <button type="submit" class="btn-primary">Sign Up</button>
            <p>Already have an account? <a href="#" id="showSignInModal">Sign In</a></p>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="footer" data-aos="fade-up" data-aos-delay="100">
    <div class="container">
      <div class="footer-grid">
        <div class="footer-brand">
          <div class="logo">
            <span class="logo-icon">EP</span>
            <span class="logo-text">EXPERT POLYHOMES</span>
          </div>
          <p>Protecting Nairobi homes with stylish mosquito nets.</p>
        </div>
        <div class="footer-links">
          <h3>Solutions</h3>
          <ul>
            <li><a href="#design-explorer" data-tab="fixed">Fixed Nets</a></li>
            <li><a href="#design-explorer" data-tab="roller">Roller Nets</a></li>
            <li><a href="#design-explorer" data-tab="slider">Slider Nets</a></li>
            <li><a href="#design-explorer" data-tab="magnetic">Magnetic Nets</a></li>
          </ul>
        </div>
        <div class="footer-links">
          <h3>Company</h3>
          <ul>
            <li><a href="#process">Our Process</a></li>
            <li><a href="#design-explorer">Design Guide</a></li>
            <li><a href="#testimonials">Customer Stories</a></li>
            <li><a href="#">Careers</a></li>
          </ul>
        </div>
        <div class="footer-contact">
          <h3>Contact Us</h3>
          <div class="contact-method">
            <i class="icon-phone"></i>
            <span>+254 723 544 097</span>
          </div>
          <div class="contact-method">
            <i class="icon-email"></i>
            <span>polyhomesexpert@gmail.com</span>
          </div>
          <div class="contact-method">
            <i class="icon-location"></i>
            <span>Nairobi, Kenya</span>
          </div>
          <div class="social-links">
            <a href="#" class="social-icon" aria-label="WhatsApp"><i class="icon-whatsapp"></i></a>
            <a href="#" class="social-icon" aria-label="Facebook"><i class="icon-facebook"></i></a>
            <a href="#" class="social-icon" aria-label="Instagram"><i class="icon-instagram"></i></a>
            <a href="#" class="social-icon" aria-label="LinkedIn"><i class="icon-linkedin"></i></a>
          </div>
        </div>
      </div>
      <div class="footer-bottom">
        <div class="copyright">
          &copy; 2025 EXPERT POLYHOMES. All rights reserved.
        </div>
        <div class="legal-links">
          <a href="/privacy-policy.html">Privacy Policy</a>
          <a href="/terms-of-service.html">Terms of Service</a>
          <a href="/cookie-policy.html">Cookie Policy</a>
        </div>
      </div>
    </div>
  </footer>

  <!-- Scripts -->
  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/build/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/controls/OrbitControls.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/loaders/GLTFLoader.js"></script>
  <script src="script.js"></script>
  <script>
    // AR View Modal Logic (unchanged from previous)
    const arBtn = document.getElementById('arView');
    const arModal = document.getElementById('arModal');
    const closeArModal = document.getElementById('closeArModal');
    const arForm = document.getElementById('arDimensionForm');
    const arCamera = document.getElementById('arCamera');
    const rulerOverlay = document.getElementById('rulerOverlay');
    const rulerLength = document.getElementById('rulerLength');
    let stream = null;

    arBtn.addEventListener('click', async () => {
      arModal.style.display = 'block';
      if (!stream) {
        try {
          stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } });
          arCamera.srcObject = stream;
        } catch (e) {
          alert('Camera access denied or not available.');
          console.error('Camera error:', e);
        }
      }
    });

    closeArModal.addEventListener('click', () => {
      arModal.style.display = 'none';
      if (stream) {
        stream.getTracks().forEach(track => track.stop());
        stream = null;
        arCamera.srcObject = null;
      }
    });

    window.addEventListener('click', (event) => {
      if (event.target === arModal) {
        arModal.style.display = 'none';
        if (stream) {
          stream.getTracks().forEach(track => track.stop());
          stream = null;
          arCamera.srcObject = null;
        }
      }
    });

    let dragging = false, startX = 0, startWidth = 60;
    const CARD_CM = 8.5;

    rulerOverlay.addEventListener('mousedown', (e) => {
      dragging = true;
      startX = e.clientX;
      startWidth = parseInt(rulerOverlay.style.width, 10);
      document.body.style.userSelect = 'none';
    });

    document.addEventListener('mousemove', (e) => {
      if (dragging) {
        let dx = e.clientX - startX;
        let newWidth = Math.max(30, Math.min(300, startWidth + dx));
        rulerOverlay.style.width = newWidth + 'px';
        let pxPerCm = newWidth / CARD_CM;
        rulerLength.textContent = `Card: ${CARD_CM} cm`;
        rulerLength.style.left = rulerOverlay.style.left;
      }
    });

    document.addEventListener('mouseup', () => {
      if (dragging) {
        dragging = false;
        document.body.style.userSelect = '';
      }
    });

    arForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      const width = document.getElementById('arWidth').value;
      const height = document.getElementById('arHeight').value;
      try {
        const response = await fetch('/api/quotes', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${localStorage.getItem('token') || ''}`
          },
          body: JSON.stringify({
            windowCount: 1,
            measurements: [{ width: width / 100, height: height / 100 }],
            material: 'fiberglass',
            type: 'fixed',
            location: document.getElementById('installLocation')?.value || 'Nairobi',
            warranty: 'basic'
          })
        });
        const data = await response.json();
        if (data.success) {
          alert(`Quote generated!\nWidth: ${width} cm\nHeight: ${height} cm\nTotal Cost: KES ${data.quote.totalCost}`);
        } else {
          alert('Error generating quote. Please try again.');
        }
      } catch (error) {
        console.error('Quote submission error:', error);
        alert('Error submitting measurements.');
      }
      arModal.style.display = 'none';
      if (stream) {
        stream.getTracks().forEach(track => track.stop());
        stream = null;
        arCamera.srcObject = null;
      }
    });

    // Map Initialization
    function initMap() {
      const map = L.map('serviceMap').setView([-1.286389, 36.817223], 11);
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
      }).addTo(map);
      L.circle([-1.286389, 36.817223], {
        color: '#133A41',
        fillColor: '#344532',
        fillOpacity: 0.3,
        radius: 15000
      }).addTo(map);
      L.marker([-1.286389, 36.817223]).addTo(map)
        .bindPopup('Expert Polyhomes HQ')
        .openPopup();
      document.getElementById('checkLocation').addEventListener('click', async () => {
        const address = document.getElementById('locationInput').value;
        if (!address) {
          alert('Please enter your address.');
          return;
        }
        try {
          const response = await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(address + ', Kenya')}`);
          const data = await response.json();
          if (data.length > 0) {
            const { lat, lon } = data[0];
            L.marker([lat, lon]).addTo(map)
              .bindPopup('Your Location')
              .openPopup();
            map.setView([lat, lon], 13);
            const coverageResponse = await fetch('/api/coverage', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ address })
            });
            const coverageData = await coverageResponse.json();
            if (coverageData.success) {
              document.getElementById('installTime').textContent = coverageData.installationDays + ' business days';
            }
          } else {
            alert('Address not found. Please try a more specific address.');
          }
        } catch (error) {
          console.error('Geocoding error:', error);
          alert('Error checking address. Please try again.');
        }
      });
    }
    document.addEventListener('DOMContentLoaded', initMap);
  </script>
</body>
</html>